{% assign number_of_comments = article.comments_count %}
{% if comment and comment.created_at %}
  {% assign number_of_comments = article.comments_count %}
{% endif %}


{% capture author %}<strong>{{ article.author }}</strong>{% endcapture %}
{% capture date %}<time datetime="{{ article.published_at | date: '%d-%m-%Y' }}">{{ article.published_at | date: format: 'abbreviated_date'  }}</time>{% endcapture %}
<div class="position-relative text-center bg-light p-3 p-md-5">
  <div class="col-md-5 p-lg-5 mx-auto my-5">
    <h1 class="display-4">{{ article.title }}</h1>
    <p class="lead">By {{ author }} published on {{ date }}</p>
  </div>
</div>

<div class="container my-5">
  <div class="row">
    <div class="col-12 col-md-8">
      {{ article.content }}
      <div class="comment-section">

        {% if blog.comments_enabled? %}
          <h2>{{ number_of_comments }} comment{% if number_of_comments > 1 %}s{% endif %}
          </h2>
          {% paginate article.comments by 5 %}
            {% for comment in article.comments %}
              <div class="card shadow rounded-0 my-3">
                <div class="card-header">
                  <strong>By</strong>
                  {{ comment.author }}
                  <strong>on</strong>
                  {{ comment.created_at | date: format: 'long' }}</div>
                <div class="card-body">
                  <div class="card-title">{{ comment.content }}</div>
                </div>
              </div>
            {% endfor %}
            {% render 'pagination' | paginate: paginate %}
          {% endpaginate %}
          <hr>
          <div>
            {% form 'new_comment'
              , article %}
              {% render 'form-errors', form: form %}

              <div class="my-5 p-2 bg-light shadow">
                <h6>Post a Comment</h6>
                <div class="form-floating my-2">

                  <input
                    class="form-control"
                    type="text"
                    name="comment[author]"
                    id="CommentAuthor"
                    placeholder="name"
                    value="{{ form.author }}"
                    autocapitalize="words"><label for="CommentAuthor">name</label>
                </div>

                <div class="form-floating my-2">
                  <input
                    class="form-control"
                    type="email"
                    name="comment[email]"
                    id="CommentEmail"
                    placeholder="email"
                    value="{{ form.email }}"
                    autocorrect="off"
                    autocapitalize="off">
                  <label for="CommentEmail">email</label>
                </div>

                <div class="form-floating my-2">
                  <textarea
                    class="form-control h-25"
                    name="comment[body]"
                    id="CommentBody"
                    rows="4"
                    cols="10"
                    placeholder="message">{{ form.body }}</textarea>
                  <label for="CommentBody">message</label>
                </div>


                <input
                  class="btn btn-primary my-2"
                  type="submit"
                  value="post">
              </div>
            {% endform %}
          </div>
        {% endif %}
      </div>
    </div>
    {% comment %} THIS COLUMN IS FOR SIDEBAR {% endcomment %}
    <div class="col-12 col-md-4">
      {% section 'sidebar' %}
    </div>
  </div>
</div>